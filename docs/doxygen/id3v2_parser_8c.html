<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>id3dev: /Users/ewanjones/projects/id3dev/src/id3v2/id3v2Parser.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">id3dev<span id="projectnumber">&#160;26.01</span>
   </div>
   <div id="projectbrief">An ID3 metadata library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('id3v2_parser_8c.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">id3v2Parser.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementations for binary parsing of ID3v2 tags, headers, frames, and complete tag structures from byte buffers.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;limits.h&gt;</code><br />
<code>#include &quot;<a class="el" href="id3v2_context_8h_source.html">id3v2/id3v2Context.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="id3v2_frame_8h_source.html">id3v2/id3v2Frame.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="id3v2_parser_8h_source.html">id3v2/id3v2Parser.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="id3v2_tag_identity_8h_source.html">id3v2/id3v2TagIdentity.h</a>&quot;</code><br />
<code>#include &quot;id3dependencies/ByteStream/include/byteStream.h&quot;</code><br />
<code>#include &quot;id3dependencies/ByteStream/include/byteInt.h&quot;</code><br />
<code>#include &quot;id3dependencies/ByteStream/include/byteUnicode.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for id3v2Parser.c:</div>
<div class="dyncontent">
<div class="center"><img src="id3v2_parser_8c__incl.png" border="0" usemap="#a_2_users_2ewanjones_2projects_2id3dev_2src_2id3v2_2id3v2_parser_8c" loading="lazy" alt=""/></div>
<map name="a_2_users_2ewanjones_2projects_2id3dev_2src_2id3v2_2id3v2_parser_8c" id="a_2_users_2ewanjones_2projects_2id3dev_2src_2id3v2_2id3v2_parser_8c">
<area shape="rect" title="Implementations for binary parsing of ID3v2 tags, headers, frames, and complete tag structures from b..." alt="" coords="487,5,690,46"/>
<area shape="rect" title=" " alt="" coords="5,102,66,127"/>
<area shape="poly" title=" " alt="" coords="487,34,398,41,295,53,185,71,78,97,74,98,72,93,76,91,184,66,294,47,398,36,487,29"/>
<area shape="rect" title=" " alt="" coords="89,102,152,127"/>
<area shape="poly" title=" " alt="" coords="487,39,334,59,249,76,166,97,161,98,159,93,164,91,248,70,333,54,486,33"/>
<area shape="rect" title=" " alt="" coords="177,102,241,127"/>
<area shape="poly" title=" " alt="" coords="487,44,374,66,254,97,249,98,247,93,252,91,373,60,486,39"/>
<area shape="rect" title=" " alt="" coords="265,102,328,127"/>
<area shape="poly" title=" " alt="" coords="505,49,425,70,342,97,338,98,336,93,340,91,424,65,504,44"/>
<area shape="rect" href="id3v2_context_8h.html" title="Function definitions for ID3v2 frame context definitions and parsing configuration." alt="" coords="353,102,497,127"/>
<area shape="poly" title=" " alt="" coords="553,49,462,96,460,92,550,44"/>
<area shape="rect" href="id3v2_frame_8h.html" title="Function definitions for ID3v2 frame lifecycle, traversal, serialization, and content management." alt="" coords="521,102,656,127"/>
<area shape="poly" title=" " alt="" coords="592,47,592,86,586,86,586,47"/>
<area shape="rect" href="id3v2_parser_8h.html" title="Definitions for binary parsing of ID3v2 tags, headers, frames, and complete tag structures from byte ..." alt="" coords="681,102,816,127"/>
<area shape="poly" title=" " alt="" coords="626,44,714,91,712,96,624,49"/>
<area shape="rect" href="id3v2_tag_identity_8h.html" title="Function definitions of ID3v2 tag header and tag structure creation, manipulation,..." alt="" coords="841,102,1001,127"/>
<area shape="poly" title=" " alt="" coords="665,44,860,94,859,100,664,49"/>
<area shape="rect" title=" " alt="" coords="1025,94,1216,135"/>
<area shape="poly" title=" " alt="" coords="691,40,1010,91,1009,96,690,45"/>
<area shape="rect" title=" " alt="" coords="1241,94,1432,135"/>
<area shape="poly" title=" " alt="" coords="691,33,931,56,1226,91,1226,96,931,61,691,38"/>
<area shape="rect" title=" " alt="" coords="1457,94,1648,135"/>
<area shape="poly" title=" " alt="" coords="691,29,1021,50,1229,68,1442,91,1442,96,1228,73,1020,55,690,34"/>
<area shape="rect" href="id3v2_types_8h.html" title="Definitions for ID3v2.x tag structure, constants, and genre enumeration." alt="" coords="620,183,718,208"/>
<area shape="poly" title=" " alt="" coords="463,125,618,175,616,180,462,130"/>
<area shape="rect" href="id3v1_types_8h.html" title="Definitions for ID3v1 tag structure, constants, and genre enumeration." alt="" coords="422,264,556,290"/>
<area shape="poly" title=" " alt="" coords="642,211,531,260,529,255,640,206"/>
<area shape="rect" title=" " alt="" coords="402,345,477,371"/>
<area shape="poly" title=" " alt="" coords="619,204,562,211,499,222,445,238,425,247,412,258,405,275,406,294,414,313,424,331,419,334,409,316,401,295,400,274,408,255,422,243,443,233,498,217,561,205,619,198"/>
<area shape="rect" title=" " alt="" coords="506,345,570,371"/>
<area shape="poly" title=" " alt="" coords="661,210,620,258,559,334,555,331,616,255,657,207"/>
<area shape="rect" title=" " alt="" coords="630,264,708,290"/>
<area shape="poly" title=" " alt="" coords="672,209,672,248,666,248,666,209"/>
<area shape="rect" title=" " alt="" coords="732,256,913,297"/>
<area shape="poly" title=" " alt="" coords="693,206,772,247,770,251,691,211"/>
<area shape="rect" title=" " alt="" coords="937,256,1121,297"/>
<area shape="poly" title=" " alt="" coords="719,205,925,250,924,255,718,210"/>
<area shape="rect" title=" " alt="" coords="1145,256,1336,297"/>
<area shape="poly" title=" " alt="" coords="719,200,896,221,1130,253,1130,259,895,226,718,205"/>
<area shape="poly" title=" " alt="" coords="484,291,457,333,453,330,479,289"/>
<area shape="poly" title=" " alt="" coords="499,289,525,330,520,333,494,291"/>
<area shape="poly" title=" " alt="" coords="603,126,648,170,644,173,599,129"/>
<area shape="poly" title=" " alt="" coords="739,129,694,173,690,170,735,126"/>
<area shape="poly" title=" " alt="" coords="883,130,723,180,721,175,881,125"/>
</map>
</div>
</div>
<p><a href="id3v2_parser_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6af6334a02145872d59aee0e5d399f35" id="r_a6af6334a02145872d59aee0e5d399f35"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6af6334a02145872d59aee0e5d399f35">id3v2ParseExtendedTagHeader</a> (uint8_t *in, size_t inl, uint8_t version, <a class="el" href="id3v2_types_8h.html#a5d12fad26c30eeb3ef82d95cd51e4a39">Id3v2ExtendedTagHeader</a> **extendedTagHeader)</td></tr>
<tr class="memdesc:a6af6334a02145872d59aee0e5d399f35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses an ID3v2 extended tag header from a byte buffer.  <br /></td></tr>
<tr class="memitem:a1122a213d0e660069b91862ca4c3aaf8" id="r_a1122a213d0e660069b91862ca4c3aaf8"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1122a213d0e660069b91862ca4c3aaf8">id3v2ParseTagHeader</a> (uint8_t *in, size_t inl, <a class="el" href="id3v2_types_8h.html#af4ab0764a4a3f59536c479369ee27df2">Id3v2TagHeader</a> **tagHeader, uint32_t *tagSize)</td></tr>
<tr class="memdesc:a1122a213d0e660069b91862ca4c3aaf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses an ID3v2 tag header from a byte buffer (excluding extended header).  <br /></td></tr>
<tr class="memitem:ae4aae40460a1333380e06f830e3d3411" id="r_ae4aae40460a1333380e06f830e3d3411"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae4aae40460a1333380e06f830e3d3411">id3v2ParseFrameHeader</a> (uint8_t *in, size_t inl, uint8_t version, <a class="el" href="id3v2_types_8h.html#ae58277360e304167f2d5bbcd3e9cee99">Id3v2FrameHeader</a> **frameHeader, uint32_t *frameSize)</td></tr>
<tr class="memdesc:ae4aae40460a1333380e06f830e3d3411"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses an ID3v2 frame header from a byte buffer.  <br /></td></tr>
<tr class="memitem:a7bcd61e3096e15242f1177dd8009d072" id="r_a7bcd61e3096e15242f1177dd8009d072"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7bcd61e3096e15242f1177dd8009d072">id3v2ParseFrame</a> (uint8_t *in, size_t inl, List *context, uint8_t version, <a class="el" href="id3v2_types_8h.html#a632a0a92f37060c749ceb7b8959dd2db">Id3v2Frame</a> **frame)</td></tr>
<tr class="memdesc:a7bcd61e3096e15242f1177dd8009d072"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses an ID3v2 frame (header + content) from a byte buffer using context-driven interpretation.  <br /></td></tr>
<tr class="memitem:af15c279b192a17844bf355b171faf46d" id="r_af15c279b192a17844bf355b171faf46d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="id3v2_types_8h.html#a470730b75a95acb88dfb1736f05e8e81">Id3v2Tag</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af15c279b192a17844bf355b171faf46d">id3v2ParseTagFromBuffer</a> (uint8_t *in, size_t inl, HashTable *userPairs)</td></tr>
<tr class="memdesc:af15c279b192a17844bf355b171faf46d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses a complete ID3v2 tag from a byte buffer, including header, optional extended header, and all frames.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementations for binary parsing of ID3v2 tags, headers, frames, and complete tag structures from byte buffers. </p>
<dl class="section author"><dt>Author</dt><dd>Ewan Jones </dd></dl>
<dl class="section version"><dt>Version</dt><dd>26.01 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024-02-01 - 2026-01-13</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2024 - 2026 </dd></dl>

<p class="definition">Definition in file <a class="el" href="id3v2_parser_8c_source.html">id3v2Parser.c</a>.</p>
</div><a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a6af6334a02145872d59aee0e5d399f35" name="a6af6334a02145872d59aee0e5d399f35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6af6334a02145872d59aee0e5d399f35">&#9670;&#160;</a></span>id3v2ParseExtendedTagHeader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t id3v2ParseExtendedTagHeader </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>inl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>version</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id3v2_types_8h.html#a5d12fad26c30eeb3ef82d95cd51e4a39">Id3v2ExtendedTagHeader</a> **</td>          <td class="paramname"><span class="paramname"><em>extendedTagHeader</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses an ID3v2 extended tag header from a byte buffer. </p>
<p>Extracts and decodes extended header fields from binary data according to the ID3v2 specification. Returns the number of bytes consumed during parsing and creates a heap-allocated extended header structure. Supports version-specific parsing:</p>
<ul>
<li>ID3v2.3: Reads size (4 bytes), CRC flag (bit 7), 2 reserved bytes, padding size (4 bytes), and optional CRC-32 (4 bytes if flag set).</li>
<li>ID3v2.4: Reads extended size (4 bytes), flag bytes count (1 byte), flags byte (update at bit 6, CRC at bit 5, restrictions at bit 4), optional syncsafe CRC-32 (5 bytes), and optional restrictions byte (8 bits for tag/text/image limitations).</li>
</ul>
<p>ID3v2.2 and unsupported versions return 0 with NULL extendedTagHeader. On success, caller must free the returned structure with id3v2DestroyExtendedTagHeader.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>- Pointer to byte buffer containing extended header data. </td></tr>
    <tr><td class="paramname">inl</td><td>- Size of input buffer in bytes. </td></tr>
    <tr><td class="paramname">version</td><td>- ID3v2 version (ID3V2_TAG_VERSION_3 or ID3V2_TAG_VERSION_4). </td></tr>
    <tr><td class="paramname">extendedTagHeader</td><td>- Output parameter receiving pointer to heap-allocated extended header structure, or NULL on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint32_t - Number of bytes read from buffer on success, 0 on failure or unsupported version. </dd></dl>

<p class="definition">Definition at line <a class="el" href="id3v2_parser_8c_source.html#l00072">72</a> of file <a class="el" href="id3v2_parser_8c_source.html">id3v2Parser.c</a>.</p>

</div>
</div>
<a id="a7bcd61e3096e15242f1177dd8009d072" name="a7bcd61e3096e15242f1177dd8009d072"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bcd61e3096e15242f1177dd8009d072">&#9670;&#160;</a></span>id3v2ParseFrame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t id3v2ParseFrame </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>inl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List *</td>          <td class="paramname"><span class="paramname"><em>context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>version</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id3v2_types_8h.html#a632a0a92f37060c749ceb7b8959dd2db">Id3v2Frame</a> **</td>          <td class="paramname"><span class="paramname"><em>frame</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses an ID3v2 frame (header + content) from a byte buffer using context-driven interpretation. </p>
<p>Extracts a complete frame by first parsing the header, then interpreting frame content according to a context list that provides "hints" about data types and structure. The context-driven approach allows flexible parsing of the diverse frame types in the ID3v2 specification.</p>
<p><b>Encrypted/Compressed Frame Handling:</b> Frames with encryptionSymbol or decompressionSize set are parsed as raw binary using a generic context. The caller must decrypt/decompress and reparse to access structured content.</p>
<p><b>Context Types Supported:</b></p><ul>
<li>encodedString_context: Null-terminated strings with encoding determined by prior "encoding" byte (ISO-8859-1, UTF-8, UTF-16BE/LE)</li>
<li>latin1Encoding_context: Null-terminated Latin-1 (ISO-8859-1) strings only</li>
<li>binary_context/noEncoding_context/precision_context/numeric_context: Fixed-size raw binary/numeric data</li>
<li>bit_context: Bit-level extraction (WARNING: incorrect implementation as of jan 13 2026)</li>
<li>iter_context: Loop control marker for repeated field groups</li>
<li>adjustment_context: Variable-length data where size comes from previously parsed "adjustment" field</li>
<li>unknown_context: Skip remaining content</li>
</ul>
<p>The function creates heap-allocated content entries for each parsed field and assembles them into a complete frame structure. On success, caller must free with id3v2DestroyFrame.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>- Pointer to byte buffer containing complete frame data. </td></tr>
    <tr><td class="paramname">inl</td><td>- Size of input buffer in bytes. </td></tr>
    <tr><td class="paramname">context</td><td>- List of <a class="el" href="id3v2_types_8h.html#a33f4c5a4b231538bd0355c6b7c2ddb32" title="Parsing instructions for a single field within an ID3v2 frame.">Id3v2ContentContext</a> structures defining frame structure and data types. </td></tr>
    <tr><td class="paramname">version</td><td>- ID3v2 version (ID3V2_TAG_VERSION_2, ID3V2_TAG_VERSION_3, or ID3V2_TAG_VERSION_4). </td></tr>
    <tr><td class="paramname">frame</td><td>- Output parameter receiving pointer to heap-allocated frame structure, or NULL on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint32_t - Total bytes consumed on success, header size on partial success, or 0 on complete failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="id3v2_parser_8c_source.html#l00565">565</a> of file <a class="el" href="id3v2_parser_8c_source.html">id3v2Parser.c</a>.</p>

</div>
</div>
<a id="ae4aae40460a1333380e06f830e3d3411" name="ae4aae40460a1333380e06f830e3d3411"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4aae40460a1333380e06f830e3d3411">&#9670;&#160;</a></span>id3v2ParseFrameHeader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t id3v2ParseFrameHeader </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>inl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>version</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id3v2_types_8h.html#ae58277360e304167f2d5bbcd3e9cee99">Id3v2FrameHeader</a> **</td>          <td class="paramname"><span class="paramname"><em>frameHeader</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>frameSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses an ID3v2 frame header from a byte buffer. </p>
<p>Extracts and decodes frame header fields from binary data according to the ID3v2 specification. Returns the number of bytes consumed during parsing and creates a heap-allocated frame header structure. Supports version-specific parsing:</p>
<ul>
<li>ID3v2.2: Reads 3-byte frame ID + 3-byte size with no flag bytes.</li>
<li>ID3v2.3: Reads 4-byte frame ID + 4-byte size + 2-byte flags. Status flags: tag alter preservation, file alter preservation, read-only. Format flags: compression (+4 bytes decompression size), encryption (+1 byte symbol), grouping (+1 byte identifier).</li>
<li>ID3v2.4: Reads 4-byte frame ID + 4-byte syncsafe size + 2-byte flags. Status flags: tag alter, file alter, read-only. Format flags: grouping (+1 byte), encryption (+1 byte), unsynchronisation, compression/data length (+syncsafe size).</li>
</ul>
<p>The frameSize output represents the frame content size (excluding header). On success, caller must free the returned structure with id3v2DestroyFrameHeader. Returns 0 with NULL on complete failure, or partial byte count with appropriate NULL/non-NULL outputs on partial parsing success.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>- Pointer to byte buffer containing frame header data. </td></tr>
    <tr><td class="paramname">inl</td><td>- Size of input buffer in bytes. </td></tr>
    <tr><td class="paramname">version</td><td>- ID3v2 version (ID3V2_TAG_VERSION_2, ID3V2_TAG_VERSION_3, or ID3V2_TAG_VERSION_4). </td></tr>
    <tr><td class="paramname">frameHeader</td><td>- Output parameter receiving pointer to heap-allocated frame header structure, or NULL on failure. </td></tr>
    <tr><td class="paramname">frameSize</td><td>- Output parameter receiving frame content size in bytes (excluding header), or 0 on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint32_t - Number of bytes read from buffer on success, 0 on complete failure, or partial byte count on partial success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="id3v2_parser_8c_source.html#l00351">351</a> of file <a class="el" href="id3v2_parser_8c_source.html">id3v2Parser.c</a>.</p>

</div>
</div>
<a id="af15c279b192a17844bf355b171faf46d" name="af15c279b192a17844bf355b171faf46d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af15c279b192a17844bf355b171faf46d">&#9670;&#160;</a></span>id3v2ParseTagFromBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="id3v2_types_8h.html#a470730b75a95acb88dfb1736f05e8e81">Id3v2Tag</a> * id3v2ParseTagFromBuffer </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>inl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HashTable *</td>          <td class="paramname"><span class="paramname"><em>userPairs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses a complete ID3v2 tag from a byte buffer, including header, optional extended header, and all frames. </p>
<p>Orchestrates the full tag parsing workflow by locating the "ID3" identifier, parsing headers, processing unsynchronisation if present, and iteratively parsing all frames using a multi-pass context resolution strategy. Returns a heap-allocated tag structure containing all successfully parsed components.</p>
<p><b>Parsing Process:</b></p><ol type="1">
<li>Scans buffer to locate "ID3" magic number identifier</li>
<li>Parses tag header (version, flags, size)</li>
<li>If unsynchronisation flag set: strips $00 bytes following $FF</li>
<li>If extended header flag set: parses version-specific extended header</li>
<li>Iterates through frame data, parsing each frame using 4-pass context lookup</li>
</ol>
<p><b>Frame Context Resolution (4-Pass System):</b></p><ul>
<li>Pass 1: Exact frame ID match in default context mappings (e.g., "TIT2", "APIC")</li>
<li>Pass 2: Exact frame ID match in user-supplied custom mappings (userPairs parameter)</li>
<li>Pass 3: Generic frame type patterns - 'T' prefix (text frames), 'W' prefix (URL frames)</li>
<li>Pass 4: Fallback to generic binary context ('?') for unknown frame types</li>
</ul>
<p>Parsing continues until all frames are extracted or an unrecoverable error occurs. On partial failure, returns a tag structure with successfully parsed frames. Returns NULL only on complete failure. Caller must free returned structure with id3v2DestroyTag.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>- Pointer to byte buffer containing ID3v2 tag data (may include non-tag data before/after). </td></tr>
    <tr><td class="paramname">inl</td><td>- Size of input buffer in bytes. </td></tr>
    <tr><td class="paramname">userPairs</td><td>- Optional hash table mapping frame IDs to custom context lists (NULL for default mappings only). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Id3v2Tag* - Heap-allocated complete tag structure on success, partial tag on partial failure, or NULL on complete failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="id3v2_parser_8c_source.html#l01001">1001</a> of file <a class="el" href="id3v2_parser_8c_source.html">id3v2Parser.c</a>.</p>

</div>
</div>
<a id="a1122a213d0e660069b91862ca4c3aaf8" name="a1122a213d0e660069b91862ca4c3aaf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1122a213d0e660069b91862ca4c3aaf8">&#9670;&#160;</a></span>id3v2ParseTagHeader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t id3v2ParseTagHeader </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>inl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="id3v2_types_8h.html#af4ab0764a4a3f59536c479369ee27df2">Id3v2TagHeader</a> **</td>          <td class="paramname"><span class="paramname"><em>tagHeader</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *</td>          <td class="paramname"><span class="paramname"><em>tagSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses an ID3v2 tag header from a byte buffer (excluding extended header). </p>
<p>Extracts and validates the 10-byte tag header structure from binary data according to the ID3v2 specification. Verifies the "ID3" identifier and decodes version, flags, and tag size fields. Returns the number of bytes consumed and creates a heap-allocated tag header structure. The extended header is not parsed by this function - the returned structure has extendedHeader set to NULL.</p>
<p>Header format (10 bytes): "ID3" identifier (3 bytes) + major version (1) + minor version (1) + flags (1) + syncsafe tag size (4).</p>
<p>The tagSize output represents the total size of tag content (frames + extended header if present) excluding the 10-byte header itself. On success, caller must free the returned structure with id3v2DestroyTagHeader. Returns 0 with NULL tagHeader on complete failure. Returns ID3V2_TAG_ID_SIZE (3) with NULL tagHeader if magic number is invalid, indicating the buffer doesn't contain a valid ID3v2 tag.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">in</td><td>- Pointer to byte buffer containing tag header data. </td></tr>
    <tr><td class="paramname">inl</td><td>- Size of input buffer in bytes. </td></tr>
    <tr><td class="paramname">tagHeader</td><td>- Output parameter receiving pointer to heap-allocated tag header structure, or NULL on failure. </td></tr>
    <tr><td class="paramname">tagSize</td><td>- Output parameter receiving tag content size in bytes (excluding 10-byte header), or 0 on failure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint32_t - Number of bytes read on success, or 0 on complete failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="id3v2_parser_8c_source.html#l00250">250</a> of file <a class="el" href="id3v2_parser_8c_source.html">id3v2Parser.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="dir_5e1f16a1579bfc8de4f5c7a9974f0968.html">id3v2</a></li><li class="navelem"><a href="id3v2_parser_8c.html">id3v2Parser.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
